{"version":3,"file":"manage.js","sources":["pages/card/manage.vue","../../../Downloads/HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY2FyZC9tYW5hZ2UudnVl"],"sourcesContent":["<template>\n  <view class=\"manage-container\">\n    <uni-segmented-control \n      :current=\"currentTab\" \n      :values=\"tabs\" \n      @clickItem=\"onTabClick\"\n      style-type=\"text\"\n      active-color=\"#2979ff\"\n    />\n    \n    <view class=\"card-list\">\n      <uni-list>\n        <uni-list-item \n          v-for=\"card in cards\" \n          :key=\"card.id\"\n          :title=\"card.name\"\n          :note=\"`${card.version} | ${card.rarity} | ${card.condition}`\"\n          :rightText=\"`¥${card.price}`\"\n          clickable\n          @click=\"toCardDetail(card.id)\"\n        >\n          <template v-slot:footer>\n            <view class=\"card-status\">\n              <text :class=\"['status-badge', getStatusClass(card.status)]\">\n                {{getStatusText(card.status)}}\n              </text>\n              <text class=\"update-time\">{{card.updatedAt}}</text>\n            </view>\n          </template>\n        </uni-list-item>\n      </uni-list>\n      \n      <uni-load-more \n        :status=\"loadStatus\" \n        :content-text=\"{\n          contentdown: '上拉加载更多',\n          contentrefresh: '正在加载...',\n          contentnomore: '没有更多了'\n        }\" \n        @clickLoadMore=\"loadMore\"\n      />\n    </view>\n    \n    <view class=\"floating-btn\" @click=\"toPublishCard\">\n      <uni-icons type=\"plusempty\" size=\"30\" color=\"#fff\"></uni-icons>\n    </view>\n  </view>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      currentTab: 0,\n      tabs: ['出售中', '已下架', '已售出'],\n      cards: [],\n      page: 1,\n      pageSize: 10,\n      loadStatus: 'more',\n      statusMap: {\n        on_sale: { text: '出售中', class: 'on-sale' },\n        off_shelf: { text: '已下架', class: 'off-shelf' },\n        sold: { text: '已售出', class: 'sold' }\n      }\n    }\n  },\n  onLoad() {\n    this.loadCards()\n  },\n  onPullDownRefresh() {\n    this.page = 1\n    this.loadCards(true)\n  },\n  onReachBottom() {\n    if (this.loadStatus === 'more') {\n      this.loadMore()\n    }\n  },\n  methods: {\n    async loadCards(isRefresh = false) {\n      try {\n        this.loadStatus = 'loading'\n        const status = ['on_sale', 'off_shelf', 'sold'][this.currentTab]\n        \n        const res = await this.$api.get('/card/list', {\n          status,\n          page: this.page,\n          pageSize: this.pageSize\n        })\n        \n        if (isRefresh) {\n          this.cards = res.data.list\n          uni.stopPullDownRefresh()\n        } else {\n          this.cards = this.page === 1 ? res.data.list : [...this.cards, ...res.data.list]\n        }\n        \n        this.loadStatus = res.data.list.length < this.pageSize ? 'noMore' : 'more'\n      } catch (error) {\n        console.error('加载卡牌失败:', error)\n        this.loadStatus = 'more'\n        if (isRefresh) uni.stopPullDownRefresh()\n      }\n    },\n    loadMore() {\n      if (this.loadStatus === 'noMore') return\n      this.page++\n      this.loadCards()\n    },\n    onTabClick(e) {\n      this.currentTab = e.currentIndex\n      this.page = 1\n      this.loadCards()\n    },\n    toCardDetail(id) {\n      uni.navigateTo({\n        url: `/pages/card/detail?id=${id}&manage=true`\n      })\n    },\n    toPublishCard() {\n      uni.navigateTo({\n        url: '/pages/card/publish'\n      })\n    },\n    getStatusText(status) {\n      return this.statusMap[status]?.text || status\n    },\n    getStatusClass(status) {\n      return this.statusMap[status]?.class || ''\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.manage-container {\n  padding: 20rpx;\n  \n  .card-list {\n    margin-top: 20rpx;\n    \n    .card-status {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      margin-top: 10rpx;\n      \n      .status-badge {\n        font-size: 24rpx;\n        padding: 4rpx 12rpx;\n        border-radius: 20rpx;\n        \n        &.on-sale {\n          background-color: #e1f3d8;\n          color: #67c23a;\n        }\n        \n        &.off-shelf {\n          background-color: #fdf6ec;\n          color: #e6a23c;\n        }\n        \n        &.sold {\n          background-color: #fef0f0;\n          color: #f56c6c;\n        }\n      }\n      \n      .update-time {\n        font-size: 24rpx;\n        color: #999;\n      }\n    }\n  }\n  \n  .floating-btn {\n    position: fixed;\n    right: 40rpx;\n    bottom: 100rpx;\n    width: 100rpx;\n    height: 100rpx;\n    background-color: #2979ff;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    box-shadow: 0 4rpx 16rpx rgba(41, 121, 255, 0.3);\n    z-index: 999;\n  }\n}\n</style>","import MiniProgramPage from 'C:/Users/HP/Desktop/ocg/ocg/pages/card/manage.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;AAkDA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,YAAY;AAAA,MACZ,MAAM,CAAC,OAAO,OAAO,KAAK;AAAA,MAC1B,OAAO,CAAE;AAAA,MACT,MAAM;AAAA,MACN,UAAU;AAAA,MACV,YAAY;AAAA,MACZ,WAAW;AAAA,QACT,SAAS,EAAE,MAAM,OAAO,OAAO,UAAW;AAAA,QAC1C,WAAW,EAAE,MAAM,OAAO,OAAO,YAAa;AAAA,QAC9C,MAAM,EAAE,MAAM,OAAO,OAAO,OAAO;AAAA,MACrC;AAAA,IACF;AAAA,EACD;AAAA,EACD,SAAS;AACP,SAAK,UAAU;AAAA,EAChB;AAAA,EACD,oBAAoB;AAClB,SAAK,OAAO;AACZ,SAAK,UAAU,IAAI;AAAA,EACpB;AAAA,EACD,gBAAgB;AACd,QAAI,KAAK,eAAe,QAAQ;AAC9B,WAAK,SAAS;AAAA,IAChB;AAAA,EACD;AAAA,EACD,SAAS;AAAA,IACP,MAAM,UAAU,YAAY,OAAO;AACjC,UAAI;AACF,aAAK,aAAa;AAClB,cAAM,SAAS,CAAC,WAAW,aAAa,MAAM,EAAE,KAAK,UAAU;AAE/D,cAAM,MAAM,MAAM,KAAK,KAAK,IAAI,cAAc;AAAA,UAC5C;AAAA,UACA,MAAM,KAAK;AAAA,UACX,UAAU,KAAK;AAAA,SAChB;AAED,YAAI,WAAW;AACb,eAAK,QAAQ,IAAI,KAAK;AACtBA,wBAAAA,MAAI,oBAAoB;AAAA,eACnB;AACL,eAAK,QAAQ,KAAK,SAAS,IAAI,IAAI,KAAK,OAAO,CAAC,GAAG,KAAK,OAAO,GAAG,IAAI,KAAK,IAAI;AAAA,QACjF;AAEA,aAAK,aAAa,IAAI,KAAK,KAAK,SAAS,KAAK,WAAW,WAAW;AAAA,MACpE,SAAO,OAAO;AACdA,sBAAAA,MAAA,MAAA,SAAA,gCAAc,WAAW,KAAK;AAC9B,aAAK,aAAa;AAClB,YAAI;AAAWA,wBAAG,MAAC,oBAAoB;AAAA,MACzC;AAAA,IACD;AAAA,IACD,WAAW;AACT,UAAI,KAAK,eAAe;AAAU;AAClC,WAAK;AACL,WAAK,UAAU;AAAA,IAChB;AAAA,IACD,WAAW,GAAG;AACZ,WAAK,aAAa,EAAE;AACpB,WAAK,OAAO;AACZ,WAAK,UAAU;AAAA,IAChB;AAAA,IACD,aAAa,IAAI;AACfA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,yBAAyB,EAAE;AAAA,OACjC;AAAA,IACF;AAAA,IACD,gBAAgB;AACdA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK;AAAA,OACN;AAAA,IACF;AAAA,IACD,cAAc,QAAQ;;AACpB,eAAO,UAAK,UAAU,MAAM,MAArB,mBAAwB,SAAQ;AAAA,IACxC;AAAA,IACD,eAAe,QAAQ;;AACrB,eAAO,UAAK,UAAU,MAAM,MAArB,mBAAwB,UAAS;AAAA,IAC1C;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClIA,GAAG,WAAW,eAAe;"}